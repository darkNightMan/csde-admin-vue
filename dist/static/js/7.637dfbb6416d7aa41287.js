webpackJsonp([7],{"1oXs":function(e,t){},d1Qp:function(e,t,a){"use strict";var r=a("1oXs");a.n(r).a},rWE6:function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=a("woOf"),s=a.n(r),n=a("//Fk"),o=a.n(n),i=a("Xxa5"),l=a.n(i),c=a("exGp"),u=a.n(c),d=a("2CGT"),m={props:["$params","$tabsIndex"],data:function(){return{imageUrl:"",loading:!1,Headers:{token:localStorage.getItem("token")},uploadUrl:d.a.uploadImage,form:{title:"",class_id:"",tagsArr:[],cover_url:"",is_top:!1,content:"",article_id:""},classIdArr:[],tagsIdArr:[],rules:{title:[{required:!0,message:"请输入标题",trigger:"blur"}]}}},created:function(){this.init()},methods:{saveDoc:function(){},imgAdd:function(e,t){var a=this;return u()(l.a.mark(function r(){var s,n,o;return l.a.wrap(function(r){for(;;)switch(r.prev=r.next){case 0:return(s=new FormData).append("images",t,"csde_"+Date.parse(new Date)+".jpeg"),a.loading=!0,r.next=5,a.Req.upload(d.a.uploadImage,s,{headers:{"Content-Type":"multipart/form-data"}});case 5:n=r.sent,o=n.data,200===n.code?a.$refs.editor.$img2Url(e,o.path):a.$refs.editor.toolbar_left.$imgDelByFilename(t.name),a.loading=!1;case 10:case"end":return r.stop()}},r,a)}))()},updateDoc:function(e,t){console.log(t)},onSubmit:function(){var e=this;return u()(l.a.mark(function t(){return l.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(void 0!==e.$params.article_id){t.next=4;break}e.$refs.form.validate(function(){var t=u()(l.a.mark(function t(a){return l.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(!a){t.next=5;break}return t.next=3,e.createArticle();case 3:t.next=7;break;case 5:return console.log("error submit!!"),t.abrupt("return",!1);case 7:case"end":return t.stop()}},t,e)}));return function(e){return t.apply(this,arguments)}}()),t.next=6;break;case 4:return t.next=6,e.updateArticle();case 6:e.loading=!1;case 7:case"end":return t.stop()}},t,e)}))()},init:function(){var e=this;return u()(l.a.mark(function t(){var a;return l.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,o.a.all([e.Req.get(d.a.articleClassListAll),e.Req.get(d.a.articleTagsListAll)]);case 2:a=t.sent,e.classIdArr=a[0].data.list,e.tagsIdArr=a[1].data.list,void 0!==e.$params.article_id&&e.getDetail();case 6:case"end":return t.stop()}},t,e)}))()},createArticle:function(){var e=this;return u()(l.a.mark(function t(){var a,r,s;return l.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return e.loading=!0,t.next=3,e.Req.post(d.a.createArticle,e.form);case 3:a=t.sent,r=a.code,s=a.msg,200===r&&(e.$message({type:"success",message:s}),e.$params.init(),e.$closeTabs(e.$tabsIndex));case 7:case"end":return t.stop()}},t,e)}))()},updateArticle:function(){var e=this;return u()(l.a.mark(function t(){var a,r;return l.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,e.Req.put(d.a.updateArticle,s()(e.form,{article_id:e.$params.article_id}));case 2:a=t.sent,r=a.msg,200===a.code&&(e.$message({type:"success",message:r}),e.$params.init(),e.$closeTabs(e.$tabsIndex));case 6:case"end":return t.stop()}},t,e)}))()},handleAvatarSuccess:function(e,t){this.form.cover_url=e.data.path,this.imageUrl=URL.createObjectURL(t.raw)},getDetail:function(){var e=this;return u()(l.a.mark(function t(){var a,r;return l.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,e.Req.get(d.a.articleDetail,{article_id:e.$params.article_id});case 2:a=t.sent,r=a.data,200===a.code&&(e.imageUrl=r.cover_url,e.form.cover_url=r.cover_url,e.form.title=r.title,e.form.class_id=r.class_id,e.form.is_top=r.is_top,e.form.content=r.content,r.tagsArr.map(function(t){return e.form.tagsArr.push(t.tags_id)}));case 6:case"end":return t.stop()}},t,e)}))()},beforeAvatarUpload:function(e){}}},f=(a("d1Qp"),a("K1/g")),p=Object(f.a)(m,function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",[a("el-card",{staticClass:"box-card"},[a("el-form",{ref:"form",attrs:{model:e.form,"label-width":"80px",rules:e.rules}},[a("el-form-item",{attrs:{label:"标题",prop:"title"}},[a("el-input",{model:{value:e.form.title,callback:function(t){e.$set(e.form,"title",t)},expression:"form.title"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"文章分类"}},[a("el-radio-group",{model:{value:e.form.class_id,callback:function(t){e.$set(e.form,"class_id",t)},expression:"form.class_id"}},e._l(e.classIdArr,function(t,r){return a("el-radio",{key:r,attrs:{label:t.id}},[e._v(e._s(t.class_name))])}),1)],1),e._v(" "),a("el-form-item",{attrs:{label:"文章标签"}},[a("el-select",{attrs:{multiple:"",placeholder:"请选择标签"},model:{value:e.form.tagsArr,callback:function(t){e.$set(e.form,"tagsArr",t)},expression:"form.tagsArr"}},e._l(e.tagsIdArr,function(e,t){return a("el-option",{key:t,attrs:{label:e.tags_name,value:e.tags_id}})}),1)],1),e._v(" "),a("el-form-item",{attrs:{label:"封面图"}},[a("el-upload",{staticClass:"avatar-uploader",attrs:{action:e.uploadUrl,headers:e.Headers,name:"images","show-file-list":!1,"on-success":e.handleAvatarSuccess,"before-upload":e.beforeAvatarUpload}},[e.imageUrl?a("img",{staticClass:"avatar",attrs:{src:e.imageUrl}}):a("i",{staticClass:"el-icon-plus avatar-uploader-icon"})])],1),e._v(" "),a("el-form-item",{attrs:{label:"是否置顶"}},[a("el-switch",{model:{value:e.form.is_top,callback:function(t){e.$set(e.form,"is_top",t)},expression:"form.is_top"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"内容"}},[a("mavon-editor",{ref:"editor",attrs:{ishljs:!0},on:{save:e.saveDoc,change:e.updateDoc,imgAdd:e.imgAdd},model:{value:e.form.content,callback:function(t){e.$set(e.form,"content",t)},expression:"form.content"}})],1),e._v(" "),a("el-form-item",[a("el-button",{attrs:{type:"primary",loading:e.loading},on:{click:e.onSubmit}},[e._v("提交")]),e._v(" "),a("el-button",[e._v("取消")])],1)],1)],1)],1)},[],!1,null,null,null);t.default=p.exports}});
//# sourceMappingURL=7.637dfbb6416d7aa41287.js.map