webpackJsonp([13],{"4uBl":function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=a("Dd8w"),l=a.n(r),i=a("Xxa5"),o=a.n(i),s=a("exGp"),n=a.n(s),c=a("2CGT"),u=a("SJI6"),d={props:[],methods:{handleSizeChange:function(e){this.queryParam.pageSize=e,this.init()},handleCurrentChange:function(e){this.queryParam.page=e,this.init()},init:function(){var e=this;return n()(o.a.mark(function t(){var a,r;return o.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return e.loading=!0,t.next=3,e.Req.get(c.a.userAllList,e.queryParam);case 3:a=t.sent,r=a.data,200===a.code&&(e.tableData=r),e.loading=!1;case 8:case"end":return t.stop()}},t,e)}))()},actionEvents:function(e){this.currRow=e},checksEdit:function(e){var t,a;this.isRoleCheck=!0,this.dialogVisiblerole=!0,this.roleValidateForm={user_id:e.user_id,nick_name:e.nick_name,password:e.password,email:e.email,phone:e.phone,avatar:e.avatar,role_id:e.sys_roles?(t=e.sys_roles,a=[],t.map(function(e){a.push(e.role_id)}),a):[]}},deleteUser:function(e){var t=this;this.$confirm("此操作将永久删除该用户, 是否继续?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(n()(o.a.mark(function a(){var r,l,i;return o.a.wrap(function(a){for(;;)switch(a.prev=a.next){case 0:return a.next=2,t.Req.delete(c.a.deleteUser,{data:{user_id:e.user_id}});case 2:r=a.sent,l=r.code,i=r.msg,200===l&&(t.init(),t.$message({type:"success",message:i}));case 6:case"end":return a.stop()}},a,t)}))).catch(function(){t.$message({type:"info",message:"已取消删除"})})},getroleList:function(){var e=this;return n()(o.a.mark(function t(){var a,r;return o.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,e.Req.get(c.a.getAllRole);case 2:a=t.sent,r=a.data,200===a.code&&(e.roleList=r.roleList);case 6:case"end":return t.stop()}},t,e)}))()},updateuUser:function(){var e=this;return n()(o.a.mark(function t(){var a,r,l;return o.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,e.Req.put(c.a.updateUser,e.roleValidateForm);case 2:a=t.sent,r=a.code,l=a.msg,200===r?(e.init(),e.$message({message:l,type:"success"}),e.dialogVisiblerole=!1):(e.dialogVisiblerole=!1,e.resetForm("roleValidateForm"));case 6:case"end":return t.stop()}},t,e)}))()},createDialog:function(){this.dialogVisiblerole=!0,this.isRoleCheck=!1,this.resetForm("roleValidateForm")},resetForm:function(e){var t=this;this.$nextTick(function(){t.$refs[e].resetFields()})},createUser:function(){var e=this;return n()(o.a.mark(function t(){var a,r,l;return o.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,e.Req.post(c.a.createUser,e.roleValidateForm);case 2:a=t.sent,r=a.code,l=a.msg,200===r?(e.init(),e.$message({message:l,type:"success"}),e.dialogVisiblerole=!1):(e.dialogVisiblerole=!1,e.$message({message:l,type:"success"}),e.resetForm("roleValidateForm"));case 6:case"end":return t.stop()}},t,e)}))()},submitForm:function(e){var t=this;this.$refs[e].validate(function(e){if(!e)return console.log("error submit!!"),!1;t.isRoleCheck?t.updateuUser():t.createUser()})}},data:function(){return{tableData:[],roleList:[],isRoleCheck:!1,dialogVisiblerole:!1,defaultProps:{children:"children",label:"res_name"},queryParam:{page:1,pageSize:10,currentPage:1},currRow:null,roleValidateForm:{nick_name:"",password:"",email:"",phone:"",avatar:"",role_id:[]}}},filters:{},computed:l()({},Object(u.mapGetters)("app",["winH"])),created:function(){this.init(),this.getroleList()}},m=a("K1/g"),p=Object(m.a)(d,function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",[a("el-dialog",{attrs:{title:e.isRoleCheck?"编辑用户":"新增用户","append-to-body":"","close-on-click-modal":!1,visible:e.dialogVisiblerole,width:"20%"},on:{"update:visible":function(t){e.dialogVisiblerole=t}}},[a("el-form",{ref:"roleValidateForm",staticClass:"demo-ruleForm",attrs:{model:e.roleValidateForm,"label-width":"100px"}},[a("el-form-item",{attrs:{label:"角色",prop:"role_id",rules:[{required:!0,message:"角色名不能为空"}]}},[a("el-select",{staticStyle:{width:"100%"},attrs:{multiple:"",placeholder:"请选择角色"},model:{value:e.roleValidateForm.role_id,callback:function(t){e.$set(e.roleValidateForm,"role_id",t)},expression:"roleValidateForm.role_id"}},e._l(e.roleList,function(e){return a("el-option",{key:e.role_id,attrs:{label:e.role_name,value:e.role_id}})}),1)],1),e._v(" "),a("el-form-item",{attrs:{label:"用户名",prop:"nick_name",rules:[{required:!0,message:"用户名不能为空"}]}},[a("el-input",{attrs:{type:"input",autocomplete:"off"},model:{value:e.roleValidateForm.nick_name,callback:function(t){e.$set(e.roleValidateForm,"nick_name",t)},expression:"roleValidateForm.nick_name"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"电话",prop:"phone",rules:[{required:!0,message:"电话名不能为空"}]}},[a("el-input",{attrs:{type:"input",autocomplete:"off"},model:{value:e.roleValidateForm.phone,callback:function(t){e.$set(e.roleValidateForm,"phone",t)},expression:"roleValidateForm.phone"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"密码",prop:"password",rules:[{required:!0,message:"密码名不能为空"}]}},[a("el-input",{attrs:{type:"input",autocomplete:"off"},model:{value:e.roleValidateForm.password,callback:function(t){e.$set(e.roleValidateForm,"password",t)},expression:"roleValidateForm.password"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"email",prop:"email"}},[a("el-input",{attrs:{type:"input",autocomplete:"off"},model:{value:e.roleValidateForm.email,callback:function(t){e.$set(e.roleValidateForm,"email",t)},expression:"roleValidateForm.email"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"avatar",prop:"avatar"}},[a("el-input",{attrs:{type:"input",autocomplete:"off"},model:{value:e.roleValidateForm.avatar,callback:function(t){e.$set(e.roleValidateForm,"avatar",t)},expression:"roleValidateForm.avatar"}})],1)],1),e._v(" "),a("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{attrs:{type:"primary"},on:{click:function(t){return e.submitForm("roleValidateForm")}}},[e._v("提交")]),e._v(" "),a("el-button",{on:{click:function(t){return e.resetForm("roleValidateForm")}}},[e._v("重置")])],1)],1),e._v(" "),a("div",{staticClass:"btn-box"},[a("el-button",{directives:[{name:"hasAuth",rawName:"v-hasAuth",value:"sys:user:create",expression:"'sys:user:create'"}],attrs:{icon:"el-icon-circle-plus-outline",type:"primary",size:"mini"},on:{click:e.createDialog}},[e._v("新建")])],1),e._v(" "),a("el-table",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}],staticStyle:{width:"100%"},attrs:{height:e.$tableHeight(),data:e.tableData.list,size:"small",border:"",stripe:"",fit:"","highlight-current-row":""},on:{"row-click":e.actionEvents}},[a("el-table-column",{attrs:{align:"center",fixed:"",prop:"user_id",label:"ID",width:"50"}}),e._v(" "),a("el-table-column",{attrs:{align:"center",fixed:"",prop:"nick_name",label:"用户名",width:"120"}}),e._v(" "),a("el-table-column",{attrs:{align:"center",label:"密码",width:"120"}},[[e._v("\n            ******\n        ")]],2),e._v(" "),a("el-table-column",{attrs:{align:"center",prop:"email",label:"邮箱",width:"180"}}),e._v(" "),a("el-table-column",{attrs:{align:"center",prop:"phone",label:"电话",width:"120"}}),e._v(" "),a("el-table-column",{attrs:{align:"center",label:"状态",width:"80"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-tag",{attrs:{type:1===t.row.state?"success":"danger",size:"small",effect:"dark"}},[e._v(" "+e._s(1==t.row.state?"正常":"禁用"))])]}}])}),e._v(" "),a("el-table-column",{attrs:{align:"center",label:"角色"},scopedSlots:e._u([{key:"default",fn:function(t){return e._l(t.row.sys_roles,function(t,r){return a("el-tag",{key:r,staticStyle:{margin:"0px 5px"},attrs:{type:"primary",effect:"dark",size:"small"}},[e._v("\n          "+e._s(t.role_name)+"\n        ")])})}}])}),e._v(" "),a("el-table-column",{attrs:{label:"头像",width:"60"},scopedSlots:e._u([{key:"default",fn:function(e){return[a("div",{staticStyle:{"text-align":"center"}},[a("el-avatar",{key:e.row.avatar,attrs:{size:25,icon:"el-icon-user-solid",src:e.row.avatar}})],1)]}}])}),e._v(" "),a("el-table-column",{attrs:{prop:"create_time",label:"创建时间"}}),e._v(" "),a("el-table-column",{attrs:{prop:"update_id",label:"更新人",width:"120"}}),e._v(" "),a("el-table-column",{attrs:{label:"操作"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-button",{directives:[{name:"hasAuth",rawName:"v-hasAuth",value:"sys:user:update",expression:"'sys:user:update'"}],attrs:{type:"primary",effect:"dark",icon:"el-icon-edit",size:"mini"},on:{click:function(a){return e.checksEdit(t.row,!1)}}},[e._v("编辑")]),e._v(" "),a("el-button",{directives:[{name:"hasAuth",rawName:"v-hasAuth",value:"sys:user:delete",expression:"'sys:user:delete'"}],attrs:{type:"danger",effect:"dark",icon:"el-icon-delete",size:"mini"},on:{click:function(a){return e.deleteUser(t.row,!1)}}},[e._v("删除")])]}}])})],1),e._v(" "),a("div",{staticClass:"page-bottom"},[a("el-pagination",{attrs:{"current-page":e.queryParam.currentPage,"page-sizes":[10,20,30,40],"page-size":e.queryParam.pageSize,layout:"total, sizes, prev, pager, next, jumper",total:e.tableData.totalCount},on:{"size-change":e.handleSizeChange,"current-change":e.handleCurrentChange}})],1)],1)},[],!1,null,null,null);t.default=p.exports}});
//# sourceMappingURL=13.cab6e46245b31316c228.js.map